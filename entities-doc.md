# אפיון יישויות - אגף סיעוד

## מבוא

בהתבסס על האפיון המפורט ועל העובדה שהפתרון מפותח באמצעות **Frappe Framework**, שהוא פלטפורמת Low Code מונעת-מטא-דאטה (Metadata driven), ניתן ליצור אפיון יישויות מובנה. פורמט זה, המכונה ב-Frappe **DocType**, הוא אידיאלי לשימוש עתידי בכלי AI ופיתוח אוטומטי, מכיוון שהוא מגדיר במפורש את הסמנטיקה (המשמעות) של הנתונים, ולא רק את אופן הצגתם.

כל ישות מוגדרת להלן כ-DocType, המייצגת גם טבלת נתונים, גם טופס (Form), וגם מחלקה (Class) ביישום.

---

## מבנה DocType מפורט

### 1. נותן שירות

| רכיב | פרטים |
|------|--------|
| **DocType ID (PK)** | `ח"פ_מספר` |
| **תכונות (Fields)** | • פרטי קשר (כתובת, טלפון, פקס, אימייל)<br>• סוגי שירותים |
| **Data Type** | • String/Text<br>• Multi-Select |
| **קשרים (FK/Link)** | N/A |
| **דרישות מיוחדות** | • ניתן לעדכון עצמי בפורטל ע"י נות"ש<br>• מזהה ייחודי להגבלת שימוש במספרי חשבוניות<br>• סוגי שירותים: טיפול בבית, מרכזי יום, קהילות תומכות, ספקי מוצרי ספיגה |

---

### 2. סניף נותן שירות

| רכיב | פרטים |
|------|--------|
| **DocType ID (PK)** | `קוד_סניף_נות_ש` |
| **תכונות (Fields)** | • קוד סניף<br>• פרטי קשר סניפיים |
| **Data Type** | • String (2 digits)<br>• String/Text |
| **קשרים (FK/Link)** | • Link (DocType: נותן שירות) |
| **דרישות מיוחדות** | • קוד מוגבל ל-2 ספרות<br>• מייצג ישות עצמאית במערכת<br>• קשר 1:1 עם DocType הסכם |

---

### 3. הסכם

| רכיב | פרטים |
|------|--------|
| **DocType ID (PK)** | `מס_הסכם` |
| **תכונות (Fields)** | • תוקף הסכם<br>• סטטוס |
| **Data Type** | • Date<br>• Select/String |
| **קשרים (FK/Link)** | • Link (DocType: סניף נותן שירות) |
| **דרישות מיוחדות** | • דורש מעקב והצגת התראה לפני תום תוקף<br>• מנוהל במערכות תשלומי מינהל |

---

### 4. מסמך / אישור

| רכיב | פרטים |
|------|--------|
| **DocType ID (PK)** | `מס_מסמך` |
| **תכונות (Fields)** | • סוג מסמך<br>• קובץ מצורף<br>• סטטוס<br>• תוקף מסמך |
| **Data Type** | • Select<br>• Attachment<br>• Select<br>• Date |
| **קשרים (FK/Link)** | • Link (DocType: הסכם) |
| **דרישות מיוחדות** | • סוגי מסמך: אישור ביטוח, ניהול תקין, פרטי בנק, הסכם בט"ל<br>• אפשרות להעלאה עצמית ע"י נות"ש<br>• סטטוס: הוגש, חסר, תקין, לא תקין (דורש פרטי סיבה)<br>• דורש הודעת מייל אוטומטית לפי סטטוס<br>• נדרש מעקב והצגת התראה |

---

### 5. איש קשר

| רכיב | פרטים |
|------|--------|
| **DocType ID (PK)** | `מס_איש_קשר` |
| **תכונות (Fields)** | • נושא אחריות<br>• פרטי קשר |
| **Data Type** | • Select<br>• String/Text |
| **קשרים (FK/Link)** | • Link (DocType: נותן שירות)<br>• Link (DocType: סניף נותן שירות) |
| **דרישות מיוחדות** | • נושאים מוגדרים: שירות, תלונות, חשבונות שוטפים, קיזוז, הדרכות, בקרות רו"ח<br>• ניתן לעדכון עצמי ע"י נות"ש |

---

### 6. תלונה

| רכיב | פרטים |
|------|--------|
| **DocType ID (PK)** | `מס_תלונה` |
| **תכונות (Fields)** | • סטטוס תלונה<br>• מקור התלונה<br>• פרטי תלונה |
| **Data Type** | • Select<br>• Select<br>• Text |
| **קשרים (FK/Link)** | • Link (DocType: נותן שירות)<br>• Link (DocType: מטפלת)<br>• Link (DocType: מבוטח) |
| **דרישות מיוחדות** | • סטטוס: מוצדקת, לא מוצדקת, במחלקה<br>• מקורות: מבוטח, מטפלות, צ"מפ, שיחה עם מבוטח, יוזמת פקיד<br>• תהליך טיפול מוגדר (שמיעה, פרוטוקול, סגירה, קנס) |

---

### 7. חשבונית

| רכיב | פרטים |
|------|--------|
| **DocType ID (PK)** | `מס_חשבונית` |
| **תכונות (Fields)** | • מספר חשבונית<br>• סוג חשבונית<br>• תקופת דיווח |
| **Data Type** | • Int (Up to 6 digits)<br>• Select<br>• String/Text |
| **קשרים (FK/Link)** | • Link (DocType: נותן שירות) |
| **דרישות מיוחדות** | • מספר ייחודי לכל ח"פ<br>• סוגים: רגיל, לפי מספר מטופלים, הכשרת מטפלות (3 סוגים שונים)<br>• נדרש לצורך קבלת כרטסת הנהלת חשבונות |

---

### 8. מטפלת

| רכיב | פרטים |
|------|--------|
| **DocType ID (PK)** | `תעודת_זהות` |
| **תכונות (Fields)** | • מידע דמוגרפי<br>• תלונות נגדה/מטעמה<br>• יומן עבודה |
| **Data Type** | • String/Text<br>• Child DocType (Table)<br>• String/Text |
| **קשרים (FK/Link)** | • Link (DocType: נותן שירות) |
| **דרישות מיוחדות** | • נותן שירות מעסיק נוכחי + היסטוריה<br>• כולל תלונות כלפי זכאים, נותני שירותים<br>• כולל חריגות אצל נותן השירות |

---

### 9. הכשרה / קורס

| רכיב | פרטים |
|------|--------|
| **DocType ID (PK)** | `מס_קורס` |
| **תכונות (Fields)** | • גוף מכשיר<br>• סטטוס קורס |
| **Data Type** | • String<br>• Select |
| **קשרים (FK/Link)** | • Many-to-Many via Table (DocType: מטפלת) |
| **דרישות מיוחדות** | • דרישת תשלום עבור הכשרה (תעריף X)<br>• סטטוס: אושר / לא אושר / הסתיים |

---

### 10. מבוטח

| רכיב | פרטים |
|------|--------|
| **DocType ID (PK)** | `תעודת_זהות` |
| **תכונות (Fields)** | • פרטי מבוטח |
| **Data Type** | • String/Text |
| **קשרים (FK/Link)** | N/A |
| **דרישות מיוחדות** | • משמש ליצירת קשר עם תלונה |

---

### 11. תיעוד תקשורת

| רכיב | פרטים |
|------|--------|
| **DocType ID (PK)** | `מס_אירוע` |
| **תכונות (Fields)** | • סוג פעולה |
| **Data Type** | • Select |
| **קשרים (FK/Link)** | • Link (DocType: נותן שירות) |
| **דרישות מיוחדות** | • סוגים: שיחה חשובה, פנייה לבירור, פנייה שנשלחה ע"י האגף |

---

## חשיבות הפורמט עבור כלי AI ופיתוח עתידי

הגדרה סמנטית זו חשובה ביותר, במיוחד לאור הבחירה ב-Frappe Framework:

### 1. ארכיטקטורה מונעת-מטא-דאטה
DocType ב-Frappe מגדיר את הנתונים באופן סמנטי. עבור כלי AI, משמעות הדבר היא שניתן "ללמד" את המודל על משמעות השדות (למשל, ש"תוקף_הסכם" הוא תאריך שדורש התראה) ולא רק על מבנה הטבלה.

### 2. יכולות API מובנות
Frappe מייצרת אוטומטית API מסוג REST לכל DocType. כך, כלי AI או מערכות חיצוניות יכולות לגשת לנתונים ולעדכן אותם באופן מיידי בהתבסס על המטא-דאטה שמוגדר כאן (לדוגמה, מערכת שתשלח אוטומטית התראה על "מסמך לא תקין").

### 3. פיתוח אוטומטי (Low Code/No Code)
מכיוון שה-DocType כולל הגדרות ממשק משתמש (Forms, List Views, Kanban), כלי AI עתידיים יוכלו לייצר תצוגות מורכבות אוטומטית, או לזהות חריגות בזרימת העבודה (Workflow) של תלונה.

### אנלוגיה
הגדרה זו היא כמו **תפריט מסעדה דיגיטלי לרובוט**. במקום לתת לרובוט תמונה של אוכל ולבקש ממנו לנחש מהן המנות, אנו נותנים לו קובץ מובנה (ה-DocType) שמגדיר במפורש את כל הרכיבים ("מטפלת" היא DocType שיש לו "תעודת_זהות" PK), מה מאפשר לו לבצע פעולות מורכבות ומדויקות (כמו לעקוב אחר תוקף של מסמך, שהוא שדה Date ב-DocType).
