# DocType with Workflow Example
# Demonstrates submittable DocType with workflow states

doctype:
  name: "Purchase Request"
  module: "Nursing Management"
  naming_rule: "autoname"
  autoname: "format:PR-{#####}"
  is_submittable: true
  track_changes: true
  description: "Purchase request with approval workflow"

  fields:
    # Basic Information Section
    - fieldname: "basic_section"
      fieldtype: "Section Break"
      label: "פרטים בסיסיים"

    - fieldname: "request_title"
      fieldtype: "Data"
      label: "שם הבקשה"
      reqd: true
      in_list_view: true
      in_standard_filter: true

    - fieldname: "request_date"
      fieldtype: "Date"
      label: "תאריך הבקשה"
      reqd: true
      default: "Today"
      in_list_view: true

    - fieldname: "column_break_1"
      fieldtype: "Column Break"

    - fieldname: "department"
      fieldtype: "Link"
      label: "מחלקה"
      options: "Department"
      reqd: true
      in_standard_filter: true

    - fieldname: "priority"
      fieldtype: "Select"
      label: "עדיפות"
      options: "נמוכה\nבינונית\nגבוהה\nדחוף"
      default: "בינונית"
      reqd: true
      in_list_view: true

    # Request Details Section
    - fieldname: "details_section"
      fieldtype: "Section Break"
      label: "פרטי הבקשה"

    - fieldname: "description"
      fieldtype: "Text Editor"
      label: "תיאור"
      reqd: true

    - fieldname: "justification"
      fieldtype: "Small Text"
      label: "הצדקה"
      description: "נמק מדוע נדרשת רכישה זו"

    - fieldname: "column_break_2"
      fieldtype: "Column Break"

    - fieldname: "estimated_cost"
      fieldtype: "Float"
      label: "עלות משוערת"
      precision: 2
      reqd: true

    - fieldname: "currency"
      fieldtype: "Select"
      label: "מטבע"
      options: "ILS\nUSD\nEUR"
      default: "ILS"

    # Items Section
    - fieldname: "items_section"
      fieldtype: "Section Break"
      label: "פריטים"

    - fieldname: "items"
      fieldtype: "Table"
      label: "פריטי הבקשה"
      options: "Purchase Request Item"
      description: "רשימת הפריטים המבוקשים"

    # Approval Section
    - fieldname: "approval_section"
      fieldtype: "Section Break"
      label: "אישורים"

    - fieldname: "workflow_state"
      fieldtype: "Select"
      label: "מצב"
      options: "טיוטה\nבהמתנה לאישור\nאושר\nנדחה"
      default: "טיוטה"
      read_only: true
      in_list_view: true
      in_standard_filter: true

    - fieldname: "approved_by"
      fieldtype: "Link"
      label: "אושר על ידי"
      options: "User"
      read_only: true

    - fieldname: "approval_date"
      fieldtype: "Datetime"
      label: "תאריך אישור"
      read_only: true

    - fieldname: "column_break_3"
      fieldtype: "Column Break"

    - fieldname: "rejection_reason"
      fieldtype: "Small Text"
      label: "סיבת דחייה"
      read_only: true

    # Attachments Section
    - fieldname: "attachments_section"
      fieldtype: "Section Break"
      label: "קבצים מצורפים"

    - fieldname: "supporting_documents"
      fieldtype: "Attach"
      label: "מסמכים תומכים"

    - fieldname: "notes"
      fieldtype: "Text"
      label: "הערות"

  permissions:
    - role: "System Manager"
      read: 1
      write: 1
      create: 1
      delete: 1
      submit: 1
      cancel: 1
      amend: 1

    - role: "Internal Reviewer"
      read: 1
      write: 1
      create: 1
      submit: 0
      delete: 0

    - role: "HQ Approver"
      read: 1
      write: 1
      create: 0
      submit: 1
      cancel: 1
      delete: 0

    - role: "Service Provider User"
      read: 1
      write: 0
      create: 0
